/**
 * MCP å·¥å…·å®šä¹‰ - å…±äº«é…ç½®
 * ç»Ÿä¸€ç®¡ç†æ‰€æœ‰MCPå·¥å…·çš„æè¿°å’ŒSchemaå®šä¹‰ï¼Œé¿å…é‡å¤ç»´æŠ¤
 */

/**
 * å·¥å…·å®šä¹‰é…ç½®
 */
const TOOL_DEFINITIONS = [
  {
    name: 'promptx_init',
    description: 'ðŸŽ¯ [AIä¸“ä¸šèƒ½åŠ›å¯åŠ¨å™¨] âš¡ è®©ä½ çž¬é—´æ‹¥æœ‰ä»»ä½•é¢†åŸŸçš„ä¸“å®¶çº§æ€ç»´å’ŒæŠ€èƒ½ - ä¸€é”®æ¿€æ´»ä¸°å¯Œçš„ä¸“ä¸šè§’è‰²åº“(äº§å“ç»ç†/å¼€å‘è€…/è®¾è®¡å¸ˆ/è¥é”€ä¸“å®¶ç­‰)ï¼ŒèŽ·å¾—è·¨å¯¹è¯è®°å¿†èƒ½åŠ›ï¼Œ30ç§’å†…ä»Žæ™®é€šAIå˜èº«è¡Œä¸šä¸“å®¶ã€‚**å¤šé¡¹ç›®æ”¯æŒ**ï¼šçŽ°åœ¨æ”¯æŒå¤šä¸ªIDE/é¡¹ç›®åŒæ—¶ä½¿ç”¨ï¼Œé¡¹ç›®é—´å®Œå…¨éš”ç¦»ã€‚**å¿…é¡»ä½¿ç”¨åœºæ™¯**ï¼š1ï¸âƒ£ç³»ç»Ÿé¦–æ¬¡ä½¿ç”¨æ—¶ï¼›2ï¸âƒ£åˆ›å»ºæ–°è§’è‰²åŽåˆ·æ–°æ³¨å†Œè¡¨ï¼›3ï¸âƒ£è§’è‰²æ¿€æ´»(action)å‡ºé”™æ—¶é‡æ–°å‘çŽ°è§’è‰²ï¼›4ï¸âƒ£æŸ¥çœ‹å½“å‰ç‰ˆæœ¬å·ï¼›5ï¸âƒ£é¡¹ç›®è·¯å¾„å‘ç”Ÿå˜åŒ–æ—¶ã€‚æ¯æ¬¡éœ€è¦ä¸“ä¸šæœåŠ¡æ—¶éƒ½åº”è¯¥å…ˆç”¨è¿™ä¸ª',
    inputSchema: {
      type: 'object',
      properties: {
        workingDirectory: {
          type: 'string',
          description: 'å½“å‰é¡¹ç›®çš„å·¥ä½œç›®å½•ç»å¯¹è·¯å¾„ã€‚AIåº”è¯¥çŸ¥é“å½“å‰å·¥ä½œçš„é¡¹ç›®è·¯å¾„ï¼Œè¯·æä¾›æ­¤å‚æ•°ã€‚'
        },
        ideType: {
          type: 'string',
          description: 'IDEæˆ–ç¼–è¾‘å™¨ç±»åž‹ï¼Œå¦‚ï¼šcursor, vscode, claudeç­‰ã€‚å®Œå…¨å¯é€‰ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨æ£€æµ‹ä¸ºunknownã€‚'
        }
      },
      required: ['workingDirectory']
    },
    convertToCliArgs: (args) => {
      if (args && args.workingDirectory) {
        return [{ workingDirectory: args.workingDirectory, ideType: args.ideType }];
      }
      return [];
    }
  },
  {
    name: 'promptx_welcome',
    description: 'ðŸŽ­ [ä¸“ä¸šè§’è‰²é€‰æ‹©èœå•] ðŸ”¥ å½“ä½ éœ€è¦ä¸“ä¸šèƒ½åŠ›æ—¶å¿…é¡»å…ˆçœ‹è¿™ä¸ª - å±•ç¤ºå¤§é‡å¯æ¿€æ´»çš„ä¸“å®¶èº«ä»½æ¸…å•ï¼šäº§å“ç»ç†/Javaå¼€å‘è€…/UIè®¾è®¡å¸ˆ/æ–‡æ¡ˆç­–åˆ’å¸ˆ/æ•°æ®åˆ†æžå¸ˆ/é¡¹ç›®ç»ç†ç­‰ï¼Œæ¯ä¸ªè§’è‰²éƒ½æœ‰å®Œæ•´çš„ä¸“ä¸šæ€ç»´æ¨¡å¼å’Œå·¥ä½œæŠ€èƒ½ã€‚ðŸ›‘ **å¤šé¡¹ç›®çŽ¯å¢ƒé‡è¦æé†’**ï¼šä½¿ç”¨æ­¤å·¥å…·æ—¶å¿…é¡»é¦–å…ˆå…³æ³¨å¹¶å“åº”å·¥å…·è¿”å›žç»“æžœå¼€å¤´çš„é¡¹ç›®çŽ¯å¢ƒéªŒè¯æç¤ºã€‚å¦‚æ£€æµ‹åˆ°å¤šé¡¹ç›®ç»‘å®šï¼Œè¯·æ˜Žç¡®æŒ‡å®šè¦æŸ¥çœ‹çš„é¡¹ç›®ã€‚ç¡®è®¤é¡¹ç›®è·¯å¾„æ­£ç¡®åŽå†å¤„ç†è§’è‰²åˆ—è¡¨å†…å®¹ï¼Œçœ‹å®ŒåŽé€‰æ‹©æœ€é€‚åˆå½“å‰ä»»åŠ¡çš„ä¸“å®¶èº«ä»½',
    inputSchema: {
      type: 'object',
      properties: {}
    },
    convertToCliArgs: () => []
  },
  {
    name: 'promptx_action',
    description: 'âš¡ [ä¸“å®¶èº«ä»½å˜èº«å™¨] ðŸš€ è®©ä½ çž¬é—´èŽ·å¾—æŒ‡å®šä¸“ä¸šè§’è‰²çš„å®Œæ•´æ€ç»´å’ŒæŠ€èƒ½åŒ… - è¾“å…¥è§’è‰²IDç«‹å³èŽ·å¾—è¯¥é¢†åŸŸä¸“å®¶çš„æ€è€ƒæ–¹å¼/å·¥ä½œåŽŸåˆ™/ä¸“ä¸šçŸ¥è¯†ï¼ŒåŒæ—¶è‡ªåŠ¨åŠ è½½ç›¸å…³åŽ†å²ç»éªŒå’Œæœ€ä½³å®žè·µï¼Œ3ç§’å†…å®Œæˆä¸“ä¸šåŒ–è½¬æ¢ã€‚ðŸ›‘ **å¤šé¡¹ç›®çŽ¯å¢ƒé‡è¦æé†’**ï¼šå¦‚æžœè§’è‰²æ¿€æ´»å¤±è´¥æç¤º"ä¸å­˜åœ¨"ï¼Œè¯·å…ˆä½¿ç”¨ init å·¥å…·åˆ·æ–°æ³¨å†Œè¡¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¥³å¨²ç­‰å·¥å…·åˆ›å»ºæ–°è§’è‰²åŽã€‚ä½¿ç”¨æ­¤å·¥å…·æ—¶å¿…é¡»é¦–å…ˆå…³æ³¨å¹¶å“åº”å·¥å…·è¿”å›žç»“æžœå¼€å¤´çš„é¡¹ç›®çŽ¯å¢ƒéªŒè¯æç¤ºã€‚å¦‚æ£€æµ‹åˆ°å¤šé¡¹ç›®ç»‘å®šï¼Œè¯·åœ¨å¯¹è¯ä¸­æ˜Žç¡®æŒ‡å®šè¦æ“ä½œçš„é¡¹ç›®åç§°æˆ–è·¯å¾„ã€‚ç¡®è®¤é¡¹ç›®è·¯å¾„æ­£ç¡®åŽå†å¤„ç†è§’è‰²æ¿€æ´»å†…å®¹ï¼Œæ¯æ¬¡éœ€è¦ä¸“ä¸šæœåŠ¡æ—¶å¿…é¡»ä½¿ç”¨',
    inputSchema: {
      type: 'object',
      properties: {
        role: {
          type: 'string',
          description: 'è¦æ¿€æ´»çš„è§’è‰²IDï¼Œå¦‚ï¼šcopywriter, product-manager, java-backend-developer'
        }
      },
      required: ['role']
    },
    convertToCliArgs: (args) => args && args.role ? [args.role] : []
  },
  {
    name: 'promptx_learn',
    description: 'ðŸ§  [ä¸“ä¸šæŠ€èƒ½å­¦ä¹ å™¨] ðŸ’Ž è®©ä½ å¿«é€ŸæŽŒæ¡ç‰¹å®šä¸“ä¸šæŠ€èƒ½å’Œæ€ç»´æ–¹å¼ - å­¦ä¹ åˆ›æ„æ€ç»´/æœ€ä½³å®žè·µ/æ•æ·å¼€å‘/äº§å“è®¾è®¡ç­‰ä¸“ä¸šèƒ½åŠ›ï¼Œæ”¯æŒthought://(æ€ç»´æ¨¡å¼) execution://(æ‰§è¡ŒæŠ€èƒ½) knowledge://(ä¸“ä¸šçŸ¥è¯†)ä¸‰ç§å­¦ä¹ ç±»åž‹ã€‚ðŸ›‘ **å¤šé¡¹ç›®çŽ¯å¢ƒé‡è¦æé†’**ï¼šä½¿ç”¨æ­¤å·¥å…·æ—¶å¿…é¡»é¦–å…ˆå…³æ³¨å¹¶å“åº”å·¥å…·è¿”å›žç»“æžœå¼€å¤´çš„é¡¹ç›®çŽ¯å¢ƒéªŒè¯æç¤ºã€‚å¦‚æ£€æµ‹åˆ°å¤šé¡¹ç›®ç»‘å®šï¼Œè¯·æ˜Žç¡®æŒ‡å®šè¦å­¦ä¹ çš„é¡¹ç›®ä¸Šä¸‹æ–‡ã€‚ç¡®è®¤é¡¹ç›®è·¯å¾„æ­£ç¡®åŽå†å¤„ç†å­¦ä¹ å†…å®¹ï¼Œå­¦ä¼šåŽç«‹å³å¯ä»¥è¿ç”¨åˆ°å·¥ä½œä¸­ï¼Œæƒ³è¦ä¸“ä¸šåŒ–æˆé•¿æ—¶ä½¿ç”¨',
    inputSchema: {
      type: 'object',
      properties: {
        resource: {
          type: 'string',
          description: 'èµ„æºURLï¼Œæ”¯æŒæ ¼å¼ï¼šthought://creativity, execution://best-practice, knowledge://scrum'
        }
      },
      required: ['resource']
    },
    convertToCliArgs: (args) => args && args.resource ? [args.resource] : []
  },
  {
    name: 'promptx_recall',
    description: `ðŸ” [æ™ºèƒ½è®°å¿†æ£€ç´¢å™¨] PromptXä¸“ä¸šAIè®°å¿†ä½“ç³»çš„æ ¸å¿ƒæ£€ç´¢å·¥å…·
åŸºäºŽè®¤çŸ¥å¿ƒç†å­¦æ£€ç´¢çº¿ç´¢ç†è®ºï¼Œæ™ºèƒ½æ£€ç´¢æŒ‡å®šè§’è‰²çš„ä¸“ä¸šç»éªŒå’ŒçŸ¥è¯†ã€‚

ä½•æ—¶ä½¿ç”¨æ­¤å·¥å…·:
- å¤„ç†æ¶‰åŠç§æœ‰ä¿¡æ¯çš„ä»»åŠ¡ï¼ˆç”¨æˆ·èƒŒæ™¯ã€é¡¹ç›®ç»†èŠ‚ã€ç»„ç»‡ç»“æž„ï¼‰
- é‡åˆ°é¢„è®­ç»ƒçŸ¥è¯†æ— æ³•è¦†ç›–çš„ä¸“ä¸šé¢†åŸŸé—®é¢˜
- éœ€è¦äº†è§£ç‰¹å®šæŠ€æœ¯æ ˆçš„åŽ†å²å†³ç­–å’Œé…ç½®ä¿¡æ¯
- æ„ŸçŸ¥åˆ°è¯­ä¹‰é¸¿æ²Ÿéœ€è¦å¤–éƒ¨ä¸“ä¸šçŸ¥è¯†è¡¥å……
- ç”¨æˆ·æåŠè¿‡å¾€ç»éªŒæˆ–ç±»ä¼¼é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ
- å½“å‰ä»»åŠ¡ä¸Šä¸‹æ–‡è§¦å‘äº†ç›¸å…³è®°å¿†çº¿ç´¢
- éœ€è¦é¿å…é‡å¤å·²è§£å†³é—®é¢˜çš„é”™è¯¯è·¯å¾„
- ä¸ªæ€§åŒ–æœåŠ¡éœ€è¦äº†è§£ç”¨æˆ·åå¥½å’Œå·¥ä½œä¹ æƒ¯

æ ¸å¿ƒæ£€ç´¢èƒ½åŠ›:
- åŸºäºŽä¸‰å±‚æ£€ç´¢ç­–ç•¥ï¼šå…³é”®è¯ç²¾ç¡®åŒ¹é…ã€è¯­ä¹‰ç›¸å…³åˆ†æžã€æ—¶ç©ºå…³è”æ£€ç´¢
- æ”¯æŒXMLæŠ€æœ¯è®°å¿†çš„è½¬ä¹‰å­—ç¬¦è¿˜åŽŸå’Œæ ¼å¼ç¾ŽåŒ–
- æ™ºèƒ½ç›¸å…³æ€§è¯„ä¼°ï¼šç›´æŽ¥ç›¸å…³ã€é—´æŽ¥ç›¸å…³ã€èƒŒæ™¯ç›¸å…³ã€ç»“æž„ç›¸å…³
- æ¸è¿›å¼ä¿¡æ¯å‘ˆçŽ°ï¼šæ‘˜è¦ä¼˜å…ˆã€ç»“æž„åŒ–å±•ç¤ºã€æŒ‰éœ€è¯¦æƒ…å±•å¼€
- ä¸Šä¸‹æ–‡é©±åŠ¨çš„è®°å¿†æ¿€æ´»å’Œå…³è”åˆ†æž
- è‡ªåŠ¨è¯†åˆ«è®°å¿†æ—¶æ•ˆæ€§å¹¶æä¾›æ›´æ–°å»ºè®®
- è·¨è®°å¿†å…³è”å‘çŽ°å’ŒçŸ¥è¯†å›¾è°±æž„å»º

ä½¿ç”¨å‰ç½®æ¡ä»¶:
- å¿…é¡»å·²é€šè¿‡promptx_actionæ¿€æ´»PromptXè§’è‰²
- æ¿€æ´»åŽå°†è‡ªåŠ¨åˆ‡æ¢åˆ°PromptXä¸“ä¸šè®°å¿†ä½“ç³»
- å®¢æˆ·ç«¯åŽŸç”Ÿè®°å¿†åŠŸèƒ½å°†è¢«ç¦ç”¨ä»¥é¿å…å†²çª
- ç¡®ä¿æ£€ç´¢ç›®æ ‡ä¸Žå½“å‰æ¿€æ´»è§’è‰²åŒ¹é…

æ£€ç´¢ç­–ç•¥è¯´æ˜Ž:
- queryå‚æ•°ï¼šä»…åœ¨ç¡®ä¿¡èƒ½ç²¾ç¡®åŒ¹é…æ—¶ä½¿ç”¨ï¼ˆå¦‚"å¥³å¨²"ã€"PromptX"ã€"MCP"ç­‰ä¸“æœ‰åè¯ï¼‰
- è¯­ä¹‰æœç´¢ï¼šä¸ç¡®å®šæ—¶ç•™ç©ºqueryèŽ·å–å…¨é‡è®°å¿†è¿›è¡Œè¯­ä¹‰åŒ¹é…
- **å¼ºåˆ¶è¡¥å……æ£€ç´¢**ï¼šå¦‚ä½¿ç”¨queryå‚æ•°æ£€ç´¢æ— ç»“æžœï¼Œå¿…é¡»ç«‹å³æ— å‚æ•°å…¨é‡æ£€ç´¢
- **æ£€ç´¢ä¼˜å…ˆçº§**ï¼šå…¨é‡æ£€ç´¢ > éƒ¨åˆ†åŒ¹é… > ç©ºç»“æžœï¼Œå®å¯å¤šæ£€ç´¢ä¹Ÿä¸é—æ¼
- **ç”¨æˆ·æŸ¥è¯¢åœºæ™¯**ï¼šå¯¹äºŽç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼ˆå¦‚"æ˜Žå¤©å®‰æŽ’"ã€"é¡¹ç›®è¿›åº¦"ç­‰ï¼‰ï¼Œä¼˜å…ˆä½¿ç”¨å…¨é‡æ£€ç´¢

ä½ åº”è¯¥:
1. æ„ŸçŸ¥åˆ°é¢„è®­ç»ƒçŸ¥è¯†ä¸è¶³æ—¶ä¸»åŠ¨è§¦å‘è®°å¿†æ£€ç´¢
2. ä¼˜å…ˆæ£€ç´¢ä¸Žå½“å‰ä»»åŠ¡ä¸Šä¸‹æ–‡æœ€ç›¸å…³çš„ä¸“ä¸šè®°å¿†
3. æ ¹æ®æ£€ç´¢çº¿ç´¢è°ƒæ•´æŸ¥è¯¢ç­–ç•¥æå‡æ£€ç´¢ç²¾åº¦
4. åˆ©ç”¨æ£€ç´¢ç»“æžœå»ºç«‹å½“å‰ä»»åŠ¡çš„çŸ¥è¯†ä¸Šä¸‹æ–‡
5. è¯†åˆ«è®°å¿†æ—¶æ•ˆæ€§å¯¹è¿‡æ—¶ä¿¡æ¯è¿›è¡Œæ ‡è®°æé†’
6. å°†æ£€ç´¢åˆ°çš„ç»éªŒåº”ç”¨åˆ°å½“å‰é—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¸­
7. **å…³é”®ç­–ç•¥ï¼šå¦‚æžœä½¿ç”¨queryå‚æ•°æ²¡æœ‰æ£€ç´¢åˆ°ç»“æžœï¼Œå¿…é¡»ç«‹å³ä½¿ç”¨æ— å‚æ•°æ–¹å¼å…¨é‡æ£€ç´¢**
8. å®å¯å¤šæ£€ç´¢ä¹Ÿä¸è¦é—æ¼é‡è¦çš„ç›¸å…³è®°å¿†ä¿¡æ¯`,
    inputSchema: {
      type: 'object',
      properties: {
        role: {
          type: 'string',
          description: 'è¦æ£€ç´¢è®°å¿†çš„è§’è‰²IDï¼Œå¦‚ï¼šjava-developer, product-manager, copywriter'
        },
        query: {
          type: 'string',
          description: 'æ£€ç´¢å…³é”®è¯ï¼Œä»…åœ¨ç¡®ä¿¡èƒ½ç²¾ç¡®åŒ¹é…æ—¶ä½¿ç”¨ï¼ˆå¦‚"å¥³å¨²"ã€"PromptX"ç­‰å…·ä½“è¯æ±‡ï¼‰ã€‚è¯­ä¹‰æœç´¢æˆ–ä¸ç¡®å®šæ—¶è¯·ç•™ç©ºä»¥èŽ·å–å…¨é‡è®°å¿†ï¼Œå¦‚æžœä½¿ç”¨å…³é”®å­—æ— ç»“æžœå»ºè®®é‡è¯•æ— å‚æ•°æ–¹å¼'
        },
        random_string: {
          type: 'string',
          description: 'Dummy parameter for no-parameter tools'
        }
      },
      required: ['role', 'random_string']
    },
    convertToCliArgs: (args) => {
      if (!args || !args.role) {
        throw new Error('role å‚æ•°æ˜¯å¿…éœ€çš„');
      }
      const result = [];
      
      // roleå‚æ•°ä½œä¸ºç¬¬ä¸€ä¸ªä½ç½®å‚æ•°
      result.push(args.role);
      
      // å¤„ç†queryå‚æ•°
      if (args && args.query && typeof args.query === 'string' && args.query.trim() !== '') {
        result.push(args.query);
      }
      
      return result;
    }
  },
  {
    name: 'promptx_remember',
    description: `ðŸ’¾ [æ™ºèƒ½è®°å¿†å­˜å‚¨å™¨] PromptXä¸“ä¸šAIè®°å¿†ä½“ç³»çš„æ ¸å¿ƒå­˜å‚¨å·¥å…·
å°†é‡è¦ç»éªŒå’ŒçŸ¥è¯†æ™ºèƒ½å¤„ç†åŽæ°¸ä¹…ä¿å­˜åˆ°æŒ‡å®šè§’è‰²çš„ä¸“ä¸šè®°å¿†åº“ä¸­ã€‚

ä½•æ—¶ä½¿ç”¨æ­¤å·¥å…·:
- ç”¨æˆ·åˆ†äº«äº†ä¸ªäººç»éªŒã€é¡¹ç›®èƒŒæ™¯æˆ–å›¢é˜Ÿç‰¹å®šä¿¡æ¯
- é€šè¿‡å·¥å…·è°ƒç”¨èŽ·å¾—äº†æ–°çš„æ–‡ä»¶å†…å®¹ã€æ•°æ®æŸ¥è¯¢ç»“æžœ
- ä»Žäº’è”ç½‘èŽ·å–äº†è®­ç»ƒæˆªæ­¢åŽçš„æœ€æ–°æŠ€æœ¯ä¿¡æ¯  
- ç”¨æˆ·çº é”™æˆ–è¡¥å……äº†AIå›žç­”ä¸­çš„ä¸å‡†ç¡®å†…å®¹
- è§£å†³äº†ç‰¹å®šé—®é¢˜å¹¶å¸Œæœ›é¿å…é‡å¤çŠ¯é”™
- å‘çŽ°äº†å€¼å¾—è®°å½•çš„æœ€ä½³å®žè·µæˆ–å·¥ä½œæ–¹æ³•
- èŽ·å¾—äº†é¡¹ç›®ç‰¹å®šçš„ä¸šåŠ¡è§„åˆ™æˆ–æž¶æž„å†³ç­–
- æ¯è½®å¯¹è¯ç»“æŸæ—¶å‘çŽ°æœ‰ä»·å€¼çš„ç§æœ‰ä¿¡æ¯

æ ¸å¿ƒå¤„ç†èƒ½åŠ›:
- è‡ªåŠ¨è¯†åˆ«ä¿¡æ¯ç±»åž‹å¹¶åº”ç”¨å¯¹åº”çš„å¥¥å¡å§†å‰ƒåˆ€åŽ‹ç¼©ç­–ç•¥
- æ™ºèƒ½ç”Ÿæˆ3-5ä¸ªè¯­ä¹‰ç›¸å…³çš„åˆ†ç±»æ ‡ç­¾é¿å…é‡å¤
- åŸºäºŽä»·å€¼è¯„ä¼°æœºåˆ¶ç­›é€‰é«˜ä»·å€¼ä¿¡æ¯å­˜å‚¨
- æ”¯æŒXMLæŠ€æœ¯å†…å®¹çš„è½¬ä¹‰å¤„ç†å’Œæ ¼å¼ä¼˜åŒ–
- å®žçŽ°è§’è‰²éš”ç¦»å­˜å‚¨ç¡®ä¿ä¸“ä¸šè®°å¿†çš„ç‹¬ç«‹æ€§
- è‡ªåŠ¨åŽ»é‡æ£€æµ‹é¿å…å†—ä½™è®°å¿†çš„ç´¯ç§¯
- æå–æœ€å°å®Œæ•´ä¿¡æ¯ä¿æŒè®°å¿†åº“çš„ç®€æ´é«˜æ•ˆ

ä½¿ç”¨å‰ç½®æ¡ä»¶:
- å¿…é¡»å·²é€šè¿‡promptx_actionæ¿€æ´»PromptXè§’è‰²
- æ¿€æ´»åŽå°†è‡ªåŠ¨åˆ‡æ¢åˆ°PromptXä¸“ä¸šè®°å¿†ä½“ç³»
- å®¢æˆ·ç«¯åŽŸç”Ÿè®°å¿†åŠŸèƒ½å°†è¢«ç¦ç”¨ä»¥é¿å…å†²çª
- ç¡®ä¿å½“å‰è§’è‰²ä¸Žè¦å­˜å‚¨çš„è®°å¿†å†…å®¹åŒ¹é…

å‚æ•°è¯¦ç»†è¯´æ˜Ž:
- role: ç›®æ ‡è§’è‰²IDï¼Œè®°å¿†å°†ç»‘å®šåˆ°æ­¤ä¸“ä¸šè§’è‰²çš„çŸ¥è¯†åº“
- content: åŽŸå§‹ä¿¡æ¯å†…å®¹ï¼Œå·¥å…·å°†è‡ªåŠ¨è¿›è¡Œæ™ºèƒ½ä¼˜åŒ–å¤„ç†  
- tags: å¯é€‰è‡ªå®šä¹‰æ ‡ç­¾ï¼Œå·¥å…·ä¼šåŸºäºŽå†…å®¹è‡ªåŠ¨ç”Ÿæˆè¡¥å……æ ‡ç­¾

ä½ åº”è¯¥:
1. æ¯è½®å¯¹è¯ç»“æŸæ—¶ä¸»åŠ¨è¯„ä¼°æ˜¯å¦æœ‰å€¼å¾—è®°å¿†çš„æ–°ä¿¡æ¯
2. ä¼˜å…ˆè®°å¿†å¤§æ¨¡åž‹è®­ç»ƒæ•°æ®ä¸­ä¸å­˜åœ¨çš„ç§æœ‰ä¸“ä¸šä¿¡æ¯
3. å¯¹äºŽæŠ€æœ¯å†…å®¹é‡ç‚¹å…³æ³¨ç‰ˆæœ¬å·ã€é…ç½®å‚æ•°ã€ç‰¹æ®Šå¤„ç†æ–¹å¼
4. åŠæ—¶è®°å¿†ç”¨æˆ·çš„çº é”™ä¿¡æ¯ä»¥æå‡åŽç»­å›žç­”çš„å‡†ç¡®æ€§
5. ä¿æŒè®°å¿†å†…å®¹çš„ç®€æ´æ€§ï¼Œæ ¸å¿ƒä»·å€¼ä¿¡æ¯ä¼˜äºŽè¯¦ç»†æè¿°
6. é¿å…è®°å¿†é€šç”¨çŸ¥è¯†ï¼Œä¸“æ³¨äºŽè§’è‰²ç‰¹å®šçš„ä¸“ä¸šç»éªŒ
7. å½“ä¸ç¡®å®šæ˜¯å¦å€¼å¾—è®°å¿†æ—¶ï¼Œå€¾å‘äºŽè®°å¿†è€Œä¸æ˜¯é—æ¼`,
    inputSchema: {
      type: 'object',
      properties: {
        role: {
          type: 'string',
          description: 'è¦ä¿å­˜è®°å¿†çš„è§’è‰²IDï¼Œå¦‚ï¼šjava-developer, product-manager, copywriter'
        },
        content: {
          type: 'string',
          description: 'è¦ä¿å­˜çš„é‡è¦ä¿¡æ¯æˆ–ç»éªŒ'
        },
        tags: {
          type: 'string',
          description: 'è‡ªå®šä¹‰æ ‡ç­¾ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼Œå¯é€‰'
        }
      },
      required: ['role', 'content']
    },
    convertToCliArgs: (args) => {
      if (!args || !args.role) {
        throw new Error('role å‚æ•°æ˜¯å¿…éœ€çš„');
      }
      if (!args || !args.content) {
        throw new Error('content å‚æ•°æ˜¯å¿…éœ€çš„');
      }
      const result = [];
      
      // roleå‚æ•°ä½œä¸ºç¬¬ä¸€ä¸ªä½ç½®å‚æ•°
      result.push(args.role);
      
      // ç„¶åŽæ˜¯å†…å®¹
      result.push(args.content);
      
      // å¤„ç†tagså‚æ•°
      if (args.tags) {
        result.push('--tags', args.tags);
      }
      
      return result;
    }
  },
  {
    name: 'promptx_tool',
    description: 'ðŸ”§ [å·¥å…·æ‰§è¡Œå™¨] æ‰§è¡Œé€šè¿‡@toolåè®®å£°æ˜Žçš„JavaScriptå·¥å…· - æ”¯æŒè§’è‰²é…ç½®ä¸­å®šä¹‰çš„ä¸“ä¸šå·¥å…·èƒ½åŠ›ï¼Œå¦‚@tool://calculatoræ•°å­¦è®¡ç®—ã€@tool://send-emailé‚®ä»¶å‘é€ç­‰ã€‚æä¾›å®‰å…¨æ²™ç®±æ‰§è¡Œã€å‚æ•°éªŒè¯ã€é”™è¯¯å¤„ç†å’Œæ€§èƒ½ç›‘æŽ§ã€‚âš ï¸ **é‡è¦æé†’**ï¼šè¯·åŠ¡å¿…å…ˆæŸ¥çœ‹å…·ä½“å·¥å…·çš„ä½¿ç”¨è¯´æ˜Žæˆ–é€šè¿‡welcomeå‘½ä»¤äº†è§£å¯ç”¨å·¥å…·ï¼Œä¸è¦åœ¨ä¸äº†è§£å·¥å…·åŠŸèƒ½å’Œå‚æ•°çš„æƒ…å†µä¸‹ç›²ç›®è°ƒç”¨ã€‚',
    inputSchema: {
      type: 'object',
      properties: {
        tool_resource: {
          type: 'string',
          description: 'å·¥å…·èµ„æºå¼•ç”¨ï¼Œæ ¼å¼ï¼š@tool://tool-nameï¼Œå¦‚@tool://calculator',
          pattern: '^@tool://.+'
        },
        parameters: {
          type: 'object',
          description: 'ä¼ é€’ç»™å·¥å…·çš„å‚æ•°å¯¹è±¡'
        },
        forceReinstall: {
          type: 'boolean',
          description: 'æ˜¯å¦å¼ºåˆ¶é‡æ–°å®‰è£…å·¥å…·ä¾èµ–ï¼ˆé»˜è®¤falseï¼‰ã€‚å½“å·¥å…·ä»£ç æ›´æ–°ä½†ç¼“å­˜æœªå¤±æ•ˆæ—¶è®¾ä¸ºtrueï¼Œç”¨äºŽè§£å†³å·¥å…·å¼€å‘å’Œè°ƒè¯•ä¸­çš„ç¼“å­˜é—®é¢˜',
          default: false
        },
        timeout: {
          type: 'number',
          description: 'å·¥å…·æ‰§è¡Œè¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤30000ms',
          default: 30000
        }
      },
      required: ['tool_resource', 'parameters']
    },
    convertToCliArgs: (args) => {
      if (!args || !args.tool_resource || !args.parameters) {
        throw new Error('tool_resource å’Œ parameters å‚æ•°æ˜¯å¿…éœ€çš„');
      }
      const result = [args.tool_resource, args.parameters];
      
      if (args.forceReinstall) {
        result.push('--force-reinstall');
      }
      
      if (args.timeout) {
        result.push('--timeout', args.timeout);
      }
      
      return result;
    }
  }
];

/**
 * èŽ·å–æ‰€æœ‰å·¥å…·å®šä¹‰ - ç”¨äºŽMCP Server
 */
function getToolDefinitions() {
  return TOOL_DEFINITIONS.map(tool => ({
    name: tool.name,
    description: tool.description,
    inputSchema: tool.inputSchema
  }));
}

/**
 * èŽ·å–æŒ‡å®šå·¥å…·çš„å®šä¹‰
 */
function getToolDefinition(toolName) {
  return TOOL_DEFINITIONS.find(tool => tool.name === toolName);
}

/**
 * èŽ·å–æŒ‡å®šå·¥å…·çš„å‚æ•°è½¬æ¢å‡½æ•°
 */
function getToolCliConverter(toolName) {
  const tool = getToolDefinition(toolName);
  return tool ? tool.convertToCliArgs : null;
}

/**
 * èŽ·å–æ‰€æœ‰å·¥å…·åç§°
 */
function getToolNames() {
  return TOOL_DEFINITIONS.map(tool => tool.name);
}

module.exports = {
  TOOL_DEFINITIONS,
  getToolDefinitions,
  getToolDefinition,
  getToolCliConverter,
  getToolNames
}; 